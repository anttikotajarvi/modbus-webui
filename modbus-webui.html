<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modbus WebUI</title>
    <script type="module">
      if (import.meta.env.VITE_GH_PAGES) {
        const defaultUrl = "https://anttikotajarvi.github.io/modbus-webui";
        const runtimeUrl =
          typeof window === "undefined"
            ? defaultUrl
            : `${window.location.origin}${window.location.pathname}`.replace(
                /index\.html$/,
                "",
              );
        const url = import.meta.env.VITE_SITE_URL ?? (runtimeUrl || defaultUrl);
        const assetHref = (path) => `${url.replace(/\/$/, "")}/${path}`;

        const linkTags = [
          { rel: "canonical", href: url },
          { rel: "icon", type: "image/svg+xml", href: assetHref("favicon.svg") },
          { rel: "apple-touch-icon", href: assetHref("icon-192.png") },
          { rel: "manifest", href: assetHref("manifest.webmanifest") },
        ];
        linkTags.forEach((attrs) => {
          const link = document.createElement("link");
          Object.entries(attrs).forEach(([k, v]) => link.setAttribute(k, v));
          document.head.appendChild(link);
        });
        const metaTags = [
          {
            name: "description",
            content:
              "Single-file Modbus Web UI with profiles, name tables, and shortcuts",
          },
          { name: "robots", content: "index,follow" },
          { name: "keywords", content: "modbus,webui,automation" },
          { name: "author", content: "Modbus WebUI Maintainers" },
          { name: "theme-color", content: "#ffffff" },
          { property: "og:site_name", content: "Modbus WebUI" },
          { property: "og:locale", content: "en_US" },
          { property: "og:title", content: "Modbus WebUI" },
          {
            property: "og:description",
            content:
              "Single-file Modbus Web UI with profiles, name tables, and shortcuts",
          },
          { property: "og:url", content: url },
          { property: "og:type", content: "website" },
          { name: "twitter:card", content: "summary" },
          { name: "twitter:title", content: "Modbus WebUI" },
          {
            name: "twitter:description",
            content:
              "Single-file Modbus Web UI with profiles, name tables, and shortcuts",
          },
          { name: "twitter:site", content: "@anttikotajarvi" },
          { name: "twitter:creator", content: "@anttikotajarvi" },
        ];
        metaTags.forEach((attrs) => {
          const meta = document.createElement("meta");
          Object.entries(attrs).forEach(([k, v]) => meta.setAttribute(k, v));
          document.head.appendChild(meta);
        });

        const ldScript = document.createElement("script");
        ldScript.type = "application/ld+json";
        ldScript.text = JSON.stringify({
          "@context": "https://schema.org",
          "@type": "WebSite",
          name: "Modbus WebUI",
          url: url,
        });
        document.head.appendChild(ldScript);
        const gaScript = document.createElement("script");
        gaScript.async = true;
        gaScript.src =
          "https://www.googletagmanager.com/gtag/js?id=G-0HFN4G088N";
        document.head.appendChild(gaScript);
        const gaInit = document.createElement("script");
        gaInit.innerHTML = `
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-0HFN4G088N');
        `;
        document.head.appendChild(gaInit);
      }
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
